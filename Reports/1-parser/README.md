# lab1 实验报告
PB19111654 吕涵祺

## 实验要求
实现一个Cminus-f解析器，包括基于 flex 的词法分析器和基于 bison 的语法分析器，能将输入的代码解析成一棵语法树。
## 实验难点
实验主要分成词法分析器部分和语法分析器部分。
- 词法分析
  > 1. 熟悉flex语法规则
  > 2. 记录token的pos_start和pos_end，尤其是跨行token如注释
- 语法分析
  > 1. 熟悉bison语法规则
  > 2. 理解代码框架
  > 3. 构建语法树
## 实验设计
首先反复阅读文档以及网上搜索得到的yacc文档，理解语法格式，然后依照实验文档定义全部词法单元，注意他们的优先级，记录下token位置，并且为每个token建立语法树结点，通过pass_node()函数传至yyval，这样完成词法分析部分。

关于语法分析部分，先将文档上的三十多条语法规则解析，并在每条规则归约成功后建立新的语法树节点，其中终结符的值从yyval中获取，最终成功构建出语法树。
## 实验结果验证
首先助教提供的easy、normal、hard测试样例全部通过。
```c
void hello(void) {  //new1.cminus，匹配通过
  while(1){
    while(2){
      while(3){
        return;
      }
    }
  }
}
```
```c
void hello(void){   //new2.cminus，匹配失败
  while(while(1){

  }){
    return;
  }
}
```
故暂时得出了分析器构造正确的结论。
## 实验反馈
实验文档很奇怪。在没做实验前看文档不明白要做什么，但实验结束后又觉得文档好像还行，可能助教在写文档的时候也是因为对实验了然于心才觉得新手“应该能看懂了吧”。我的建议是文档能加一个更具体的小实例。比如文档中提到的计算器语法分析，我觉得如果实验文档能带我们从无到有写计算器的词法分析器和语法分析器，然后再链接再验证，让我们明白构造流程，最后再让我们独立完成cminus的分析器，会对新手更友好一点。